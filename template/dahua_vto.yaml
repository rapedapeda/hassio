- trigger:
    platform: event
    event_type: dahua_vto
    event_data:
      Code: VideoBlind
  binary_sensor:
    - name: Deurbel Camera Covered
      unique_id: "deurbel_camera_covered"
      state: "{{ trigger.event.data.Action | string == 'Start' }}"
      device_class: tamper

# Whether the doorbell is ringing
#  Used to trigger the doorbell automation
#  Use the ringing time from the intercom as the auto_off time
- trigger:
    platform: event
    event_type: dahua_vto
    event_data:
      Code: BackKeyLight
  binary_sensor:
    - name: Deurbel Ringing
      unique_id: "deurbel_ringing"
      auto_off: 60
      state: >
        {% if trigger.event.data.Data.State | int == 1 %}
          on
        {% elif trigger.event.data.Data.State | int == 0 %}
          off
        {% else %}
          {{ states("binary_sensor.doorbell_ringing") }}
        {% endif %}
      device_class: sound