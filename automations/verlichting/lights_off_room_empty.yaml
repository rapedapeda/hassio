- id: room_empty
  alias: Room empty lights off
  mode: parallel
  trigger:
  - platform: event
    event_type: state_changed
  - entity_id: binary_sensor.aanwezigheid_slaapkamer
    platform: state
    to: 'off'
  - entity_id: binary_sensor.aanwezigheid_badkamer
    platform: state
    to: 'off'
  - entity_id: binary_sensor.aanwezigheid_hal
    platform: state
    to: 'off'
  condition: 
  - condition: template
    value_template: >
      {{
        trigger.event.data.entity_id.startswith('binary_sensor.aanwezigheid_') 
      }}
    # Volgende excludes alles waarin override voorkomt
  - condition: template
    value_template: >
      {{
        not trigger.event.data.entity_id.endswith('override') 
      }}
    # Volgende checkt of de override sensor voor de ruimte op uit staat
  - condition: template
    value_template: >
      {{ states(trigger.entity_id + "_override") == 'off' }}
  action:
  - service: input_select.select_option
    data_template: 
      entity_id: input_select.kamer_scenes_{{ state_attr(trigger.entity_id, 'friendly_name')|lower }}
      option: Uit