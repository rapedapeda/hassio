- id: scene_aanwezigheid_aan
  alias: Scene aanwezigheid aan
  description: Automatisering die een scene activeert wanneer aanwezigheid wordt gedetecteerd en de detectie aan staat
  mode: parallel
  trigger:
    platform: event
    event_type: state_changed
  condition:
    - condition: template
      value_template: >
        {{
          trigger.event.data.entity_id.startswith('binary_sensor.aanwezigheid_') 
        }}
    - condition: template
      value_template: "{{ trigger.event.data.new_state.state == 'on' }}"
    - condition: template
      value_template: >-
        {{ is_state('binary_sensor.' + trigger.event.data.entity_id.split('_')[2] + '_aanwezigheid_detectie', 'on') }}
  action:
    - service: input_select.select_option
      data_template: 
        entity_id: input_select.kamer_scenes_{{ trigger.event.data.entity_id.split('_')[2] }}
        option: >-
          {{ states('input_select.kamer_scenes_modus_' + trigger.event.data.entity_id.split('_')[2]) }}