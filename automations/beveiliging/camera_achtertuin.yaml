- id: opname_achterkant
  alias: Opname (achterkant)
  trigger: 
    - platform: state
      entity_id:
        - binary_sensor.camera_achter_smart_motion_human
        - binary_sensor.schuifpui_contact
      to: 'on'
  condition:
    alias: "Alarm is armed"
    condition: not
    conditions:
    - condition: state
      entity_id: alarm_control_panel.huis
      state: "home"
  action:
    service: camera.record
    target:
      entity_id: camera.camera_achter_main
    data:
      filename: '/share/Opnames/Achterkant/{{ now().strftime("%Y-%m-%d") }}/{{ now().strftime("%Y%m%d-%H%M%S") }}.mp4'
      duration: 15
      lookback: 5

- id: snapshot_achterkant
  alias: Snapshot (achterkant)
  trigger: 
    - platform: state
      entity_id:
        - binary_sensor.camera_achter_smart_motion_human
        - binary_sensor.schuifpui_contact
      to: 'on'
  condition:
    alias: "Alarm is armed"
    condition: not
    conditions:
    - condition: state
      entity_id: alarm_control_panel.huis
      state: "home"
  action:
    service: camera.snapshot
    target:
      entity_id: camera.deurbel_main
    data:
      filename: '/share/Snapshot/Achterkant/{{ now().strftime("%Y-%m-%d") }}/{{ now().strftime("%Y%m%d-%H%M%S") }}.jpg'